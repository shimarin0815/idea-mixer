<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>お蔵入りネタ ミキサー</title>
    <style>
        /* Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&family=Orbitron:wght@500;700&display=swap');

        /* --- 基本スタイル --- */
        :root {
            --bg-color: #121212;
            --surface-color: #1e1e1e;
            --primary-color: #00aaff;
            --primary-hover: #0088cc;
            --secondary-color: #ff00ff; /* アクセント */
            --text-color: #f0f0f0;
            --text-muted: #888;
            --border-color: #333;
            --danger-color: #ff4444;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
        }

        /* --- ヘッダー --- */
        header {
            text-align: center;
            margin-bottom: 30px;
        }

        header h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            color: var(--text-color);
            text-shadow: 0 0 10px var(--primary-color), 0 0 20px var(--primary-color);
        }

        /* --- メインコンテナ --- */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        /* --- 企画生成セクション --- */
        .generator-section {
            background-color: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        #generate-btn {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 8px;
            padding: 15px 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(0, 170, 255, 0.5);
        }

        #generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 25px rgba(0, 170, 255, 0.8), 0 0 30px rgba(255, 0, 255, 0.5);
        }

        #result-display {
            margin-top: 25px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-color);
            border: 1px dashed var(--border-color);
            border-radius: 8px;
            padding: 20px;
        }

        #result-text {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-color);
        }
        #result-text .highlight {
            color: var(--primary-color);
            margin: 0 5px;
        }
        #result-text .separator {
            color: var(--secondary-color);
            margin: 0 10px;
            font-weight: 300;
        }

        /* --- 要素入力セクション --- */
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .category-card {
            background-color: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .category-card h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 5px;
        }

        .input-form {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .input-field {
            flex-grow: 1;
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 10px 12px;
            color: var(--text-color);
            font-size: 1rem;
        }
        .input-field:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 5px var(--primary-color);
        }

        .add-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 15px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .add-btn:hover {
            background-color: var(--primary-hover);
        }

        .item-list {
            list-style: none;
            max-height: 300px;
            overflow-y: auto;
            padding-right: 10px; /* スクロールバー用 */
        }

        /* スクロールバーのスタイル */
        .item-list::-webkit-scrollbar {
            width: 6px;
        }
        .item-list::-webkit-scrollbar-track {
            background: var(--bg-color);
            border-radius: 3px;
        }
        .item-list::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 3px;
        }
        .item-list::-webkit-scrollbar-thumb:hover {
            background: var(--primary-hover);
        }


        .item-list li {
            background-color: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 8px 12px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.2s ease;
        }
        .item-list li:hover {
            background-color: #2a2a2a;
        }

        .delete-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            transition: color 0.2s ease;
        }
        .delete-btn:hover {
            color: var(--danger-color);
        }

        /* --- フッター --- */
        footer {
            text-align: center;
            margin-top: 30px;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        #clear-all-btn {
            background: none;
            border: 1px solid var(--danger-color);
            color: var(--danger-color);
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        #clear-all-btn:hover {
            background-color: var(--danger-color);
            color: white;
        }

    </style>
</head>
<body>

    <header>
        <h1>お蔵入りネタ ミキサー</h1>
    </header>

    <main class="container">

        <section class="generator-section">
            <button id="generate-btn">企画を自動生成！</button>
            <div id="result-display">
                <span id="result-text">ボタンを押して新しい企画を生成</span>
            </div>
        </section>

        <section class="input-grid">

            <div class="category-card">
                <h2>1. テーマ (例: 料理)</h2>
                <div class="input-form">
                    <input type="text" id="theme-input" class="input-field" placeholder="新しいテーマを入力">
                    <button id="add-theme-btn" class="add-btn">追加</button>
                </div>
                <ul id="theme-list" class="item-list">
                    </ul>
            </div>

            <div class="category-card">
                <h2>2. 縛り (例: 100均の材料で)</h2>
                <div class="input-form">
                    <input type="text" id="restriction-input" class="input-field" placeholder="新しい縛りを入力">
                    <button id="add-restriction-btn" class="add-btn">追加</button>
                </div>
                <ul id="restriction-list" class="item-list">
                    </ul>
            </div>

            <div class="category-card">
                <h2>3. オチ (例: 激辛にする)</h2>
                <div class="input-form">
                    <input type="text" id="conclusion-input" class="input-field" placeholder="新しいオチを入力">
                    <button id="add-conclusion-btn" class="add-btn">追加</button>
                </div>
                <ul id="conclusion-list" class="item-list">
                    </ul>
            </div>

        </section>

    </main>

    <footer>
        <button id="clear-all-btn">全データをリセット</button>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- DOM要素の取得 ---
            const inputs = {
                theme: document.getElementById('theme-input'),
                restriction: document.getElementById('restriction-input'),
                conclusion: document.getElementById('conclusion-input')
            };

            const addBtns = {
                theme: document.getElementById('add-theme-btn'),
                restriction: document.getElementById('add-restriction-btn'),
                conclusion: document.getElementById('add-conclusion-btn')
            };

            const lists = {
                theme: document.getElementById('theme-list'),
                restriction: document.getElementById('restriction-list'),
                conclusion: document.getElementById('conclusion-list')
            };

            const generateBtn = document.getElementById('generate-btn');
            const resultText = document.getElementById('result-text');
            const clearAllBtn = document.getElementById('clear-all-btn');

            const STORAGE_KEY = 'streamingIdeaMixerData';

            // --- データ管理 ---
            let data = {
                theme: [],
                restriction: [],
                conclusion: []
            };

            // 1. データの読み込み (localStorageから)
            function loadData() {
                const savedData = localStorage.getItem(STORAGE_KEY);
                if (savedData) {
                    data = JSON.parse(savedData);
                }
                renderAllLists();
            }

            // 2. データの保存 (localStorageへ)
            function saveData() {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
            }

            // 3. リストの描画
            function renderList(category) {
                const listElement = lists[category];
                listElement.innerHTML = ''; // リストを一旦空にする

                data[category].forEach((item, index) => {
                    const li = document.createElement('li');
                    
                    const span = document.createElement('span');
                    span.textContent = item;
                    li.appendChild(span);

                    const deleteBtn = document.createElement('button');
                    deleteBtn.textContent = '×';
                    deleteBtn.className = 'delete-btn';
                    deleteBtn.dataset.category = category;
                    deleteBtn.dataset.index = index;
                    li.appendChild(deleteBtn);

                    listElement.appendChild(li);
                });
            }

            function renderAllLists() {
                renderList('theme');
                renderList('restriction');
                renderList('conclusion');
            }

            // 4. アイテムの追加
            function addItem(category) {
                const input = inputs[category];
                const value = input.value.trim();

                if (value) {
                    data[category].push(value);
                    saveData();
                    renderList(category);
                    input.value = ''; // 入力欄をクリア
                }
            }

            // 5. アイテムの削除
            function deleteItem(category, index) {
                data[category].splice(index, 1); // 配列から削除
                saveData();
                renderList(category);
            }

            // 6. 企画の自動生成
            function generateIdea() {
                const getRandomItem = (arr) => {
                    if (arr.length === 0) {
                        return '（設定なし）';
                    }
                    const randomIndex = Math.floor(Math.random() * arr.length);
                    return arr[randomIndex];
                };

                const theme = getRandomItem(data.theme);
                const restriction = getRandomItem(data.restriction);
                const conclusion = getRandomItem(data.conclusion);

                // 結果をスタイリッシュに表示
                resultText.innerHTML = `
                    <span class="highlight">${theme}</span>
                    <span class="separator">/</span>
                    <span class="highlight">${restriction}</span>
                    <span class="separator">/</span>
                    <span class="highlight">${conclusion}</span>
                `;
            }

            // --- イベントリスナーの設定 ---

            // 追加ボタン
            addBtns.theme.addEventListener('click', () => addItem('theme'));
            addBtns.restriction.addEventListener('click', () => addItem('restriction'));
            addBtns.conclusion.addEventListener('click', () => addItem('conclusion'));

            // Enterキーでも追加
            inputs.theme.addEventListener('keypress', (e) => e.key === 'Enter' && addItem('theme'));
            inputs.restriction.addEventListener('keypress', (e) => e.key === 'Enter' && addItem('restriction'));
            inputs.conclusion.addEventListener('keypress', (e) => e.key === 'Enter' && addItem('conclusion'));

            // 削除ボタン（イベント委任）
            Object.values(lists).forEach(list => {
                list.addEventListener('click', (e) => {
                    if (e.target.classList.contains('delete-btn')) {
                        const { category, index } = e.target.dataset;
                        deleteItem(category, parseInt(index, 10));
                    }
                });
            });

            // 生成ボタン
            generateBtn.addEventListener('click', generateIdea);

            // 全削除ボタン
            clearAllBtn.addEventListener('click', () => {
                if (confirm('すべてのデータをリセットします。よろしいですか？')) {
                    data = { theme: [], restriction: [], conclusion: [] };
                    saveData();
                    renderAllLists();
                    resultText.textContent = 'ボタンを押して新しい企画を生成';
                }
            });

            // --- 初期化 ---
            loadData();

        });
    </script>

</body>
</html>